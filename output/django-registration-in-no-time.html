<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Django registration in no time!</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="A Pelican Blog Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">A Pelican Blog</a></h1>
                <nav><ul>
                    <li><a href="/pages/about-me.html">About me...</a></li>
                    <li><a href="/pages/consulting.html">Consulting</a></li>
                    <li><a href="/pages/now.html">Now</a></li>
                    <li><a href="/pages/talks.html">Talks</a></li>
                    <li class="active"><a href="/category/blog.html">Blog</a></li>
                    <li><a href="/category/espanol.html">Español</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/django-registration-in-no-time.html" rel="bookmark"
           title="Permalink to Django registration in no time!">Django registration in no time!</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-01-23T00:00:00+00:00">
                Published: Tue 23 January 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/israel-fermin-montilla.html">Israel Fermín Montilla</a>
        </address>
<p>In <a href="/category/blog.html">Blog</a>.</p>
<p>tags: <a href="/tag/python.html">python</a> <a href="/tag/django.html">django</a> <a href="/tag/tutorial.html">tutorial</a> <a href="/tag/registration.html">registration</a> </p>
</footer><!-- /.post-info -->      <p>What does 99% of the projects we work on have in common?, what's usually the first or the last
thing we start working on when building something, a personal project perhaps?. If you said
<em>dealing with users</em>, that's right. On each and every project we find ourselves writing different
registration or authentication flows, sometimes we use third party authentication services like
<em>Google</em> or <em>facebook</em> via their <em>API</em>s, but most of the times I'd say we start by asking our user's
to register using their <code>email</code> and a <code>password</code>.</p>
<h2>Common approaches</h2>
<p>There are several approaches to user registration, we can do it on a single step, or we can do it on
2 steps with a confirmation email being sent to the given address. There are several ways you can structure
your registration flow, either two simple questions (<code>email</code> and <code>password</code>) or multiple questions through
several pages, you name it, we always write user registration flows.</p>
<p>Is you ask me, I've always preferred to write a simple one, ask for an <code>email</code> and a <code>password</code> and ask for the
rest of the information I need on a separate <em>User Profile</em> page, things like name, date of birth, country, city,
mobile number or other stuff I might need. But you want as least friction as possible on the registration process,
specially if you're trying to get your first users, that's why I don't even send confirmation emails when I just launched
something. I start asking for confirmation when I already got some users and I have people constantly signing up, otherwise,
it's not worth the effort or the network traffic, plus the complexity of sending it asynchronously with a message queue.</p>
<p>That's why I thought of writing a reusable django app to solve this, I was working on it for a while, taking the good parts
of all the registration flows I've written, until I found <code>django-registration</code> and just switched to that library.</p>
<h2>Enter django-registration</h2>
<p>This is way better that anything I could have written myself, it's being used by many people, has an active maintainer, works
out of the box and supports single and two steps registration flows so, why <em>reinventing the wheel</em> if it's already there?,
I'm using it for a couple of personal projects I'll be in the upcoming months (or not... you know...) and it's
incredible how easy it makes it to implement user registration, allowing me to start working on actual features and functionality
in almost no time.</p>
<p>Let's get started</p>
<h3>Installation</h3>
<p>To install it, you just need to <code>pip</code> it as any usual <em>Python</em> module</p>
<div class="highlight"><pre><span></span><code><span class="err">pip install django-registration</span>
</code></pre></div>


<p>For the simple <em>one step</em> registration flow or the <em>HMAC Based</em> workflow, you don't need to do anything else.</p>
<h3>Registration workflows</h3>
<p><em>django-registration</em>, supports three different workflows:</p>
<ul>
<li><strong>One step:</strong> this workflow consists of as few steps as possible, the user signs up by filling the registration form,
after submitting, the account is created without any intermediate verification and the user is logged in automatically.</li>
<li><strong>HMAC Based:</strong> it's a two steps registration workflow that doesn't store any verification key, it sends instead a
timestamped HMAC verified value to the user via email in order to verify the account.</li>
<li><strong>Model based:</strong> to use this workflow, you'll have to add <code>registration</code> to your <code>INSTALLED_APPS</code> as you will need
to install one model to perform the verification step. If you need a two steps account creation because you require email
verification, the recommended way is to use the <em>HMAC</em> flow.</li>
</ul>
<p>The basic <em>one step</em> registration flow is the easiest way to register new users, if you're just deploying something for fun
and it's intended mostly for your personal use but want to allow other people to use it, I don't think you need to verify
email and go through all that hassle unless you get serious about it, so in my case, the intended user for my project is just myself,
but if someone else wants to use it, I'm OK with that, I assume if you want to use something you'll just provide a legit email
because it's on your own interest.</p>
<h3>Settings everything up</h3>
<p>I decided to go for a <em>one step</em> flow, as I don't really care if anyone provides an nonexistent email, I'm the one who will mostly
be using this, so, I guess it's OK, <em>django-registration</em> allows me to restrict new accounts from being created just by adding 
<code>REGISTRATION_OPEN = False</code> on my <code>settings.py</code> file.</p>
<p>Each registration flow comes with its own set of views and urls and you'll have to create your custom template and form if you needed,
you'll most probably end up customizing some behavior, but it's really easy to do, most of the core, boring and repetitive work
of creating the registration workflow is done for you and works out of the box.</p>
<p>In this case, for the <em>one step</em> all I had to do was the following:</p>
<p>1.- Include <code>registration.backends.simple.urls</code> in my urls configuration</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Some url patterns</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;accounts/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;registration.backends.simple.urls&#39;</span><span class="p">)),</span>
    <span class="c1"># More url patterns</span>
<span class="p">]</span>
</code></pre></div>


<p>2.- Set <code>REGISTRATION_OPEN = True</code>, this is the default value, but <em>better explicit than implicit</em></p>
<p>3.- By default, after successful registration the user will be redirected to <code>/</code>, but you can customize this behavior by
subclassing <code>registration.backends.simple.views.RegistrationView</code> and overriding the method <code>get_success_url()</code>, in my case,
redirecting to <code>/</code> is fine.</p>
<p>4.- By default, <em>django-registration</em> will use <code>registration.forms.RegistrationForm</code>, this can be overridden by supplying your
own <code>form_class</code> argument when adding the default <code>RegistationView</code> to the <code>urlpatterns</code> or by subclassing it and setting the <code>form_class</code>
attribute or implementing <code>get_form_class()</code>. In my case, I opted for passing an argument to the <code>as_view()</code> method when addind the
corresponding <code>url</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">registration.backends.simple.views</span> <span class="kn">import</span> <span class="n">RegistrationView</span>

<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span>

<span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">UserRegistrationForm</span>


<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Some url patterns</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;accounts/register/$&#39;</span><span class="p">,</span> <span class="n">RegistrationView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span>
        <span class="n">form_class</span><span class="o">=</span><span class="n">UserRegistrationForm</span>
    <span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;accounts/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;registration.backends.simple.urls&#39;</span><span class="p">)),</span>
    <span class="c1"># More url patterns</span>
<span class="p">]</span>
</code></pre></div>


<p>5.- Customize the registration template, this flow only needs one template called <code>registration/registration_form.html</code> and it will
pick it up automatically, the <code>RegistrationView</code> will add the <code>form</code> variable to the <code>context</code> and it will contain a <code>RegistrationForm</code> instance,
all for free.</p>
<h2>Recommended readings</h2>
<ul>
<li><a href="https://django-registration.readthedocs.io/en/2.4.1/index.html"><em>django registration</em> docs</a></li>
<li>Django docs on <a href="https://docs.djangoproject.com/en/2.0/topics/class-based-views/">class based views</a></li>
</ul>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>