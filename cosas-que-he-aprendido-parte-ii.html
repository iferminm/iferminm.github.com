<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cosas que he aprendido (Parte II): - Israel Fermín Montilla</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="http://localhost:8000/theme/css/iferminm.css">
</head>
<body>
    <div id="header">
        <div id="header-logo-holder">
            <a href="http://localhost:8000"><img src="http://localhost:8000/theme/images/header-logo.png" alt=""></a>    
        </div>
        <div id="logo-text">
            <span><b>Israel Fermín Montilla</b></span>
            <span>Software Engineer</span>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-2">
            <div class="collapse navbar-collapse" id="nav-elements">
                <ul class="nav nav-pills nav-stacked">
                    <li class="active"><a href="http://localhost:8000">Blog</a></li>
                </ul>
            </div>
            <div class="under-menu-ad">
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- Blog under menu -->
                <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-9066997121369275"
                    data-ad-slot="3361083144"
                    data-ad-format="auto">
                </ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
        </div>
        <div class="col-xs-9">
            <div id="main-content" class="ckontainer"> 
<div class="article-header">
    <h1>Cosas que he aprendido (Parte II):</h1> 
    by <a href="author/israel-fermin-montilla.html">Israel Fermín Montilla</a>
</div>

<p>A menudo nos ocurre que estamos programando
y vemos que hay ciertos métodos que se repiten
en varias clases, esto es una señal de que ese
conjunto de métodos pueden abstraerse de alguna manera
para no tener que duplicar esa lógica, entonces,
escribimos una clase base, con esos métodos y
luego simplemente la heredamos y todo cool.</p>
<p>Cuando esto ocurre por segunda vez en un subconjunto
de las clases <em>hijas</em>, pueden pasar dos cosas:</p>
<ol class="arabic simple">
<li>Ese conjunto de métodos pertenece al mismo
dominio del problema, en cuyo caso, los
colocamos en la clase padre que corresponda</li>
<li>Ese conjunto de métodos resuelve otro tipo de
problemas o es más bien algún tipo de utilidad
pero debe estar en esa clase por alguna razón.</li>
</ol>
<p>En el segundo caso lo que uno tiende a hacer con
lenguajes que soportan herencia múltiple como Python
es crear una nueva clase y agregarla a la lista de clases
padre de la clase en cuestión.</p>
<p>Conforme nuestro programa va creciendo en complejidad,
podemos enfrentarnos al famoso problema del diamante de
la herencia múltiple, los mixins son una solución limpia
y sencilla para evitar este tipo de inconvenientes que son
un dolor de cabeza para depurar y agregan complicaciones
innecesarias.</p>
<div class="section" id="que-es-un-mixin">
<h2>¿Qué es un Mixin?</h2>
<p>Un Mixin es una clase que hereda de la clase por defecto, <em>object</em>
en el caso de Python, y define un conjunto de métodos para agregar
comportamiento a alguna otra entidad. Un mixin por sí solo puede
resultar inútil, pero al combinarlos y agregarlos a una clase
resultan ser una herramienta muy potente que ayuda a la reutilización
de código sin ambigüedades y sin generar efectos colaterales.</p>
</div>
<div class="section" id="ejemplos">
<h2>Ejemplos</h2>
<p>Bueno, basta de palabrería y manos al teclado.</p>
<p>Supongamos que estamos desarrollando algo en <em>django</em> y necesitamos
que el usuario sea capaz de dejar comentarios, esta vista debe ser
invocable vía ajax. Debo hacerlo de manera que pueda reusar el código
pues se que en el futuro habrá más vistas que deben ser &quot;ajax friendly&quot;</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">CreateView</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="kn">from</span> <span class="nn">app.models</span> <span class="kn">import</span> <span class="n">Comment</span>
<span class="kn">from</span> <span class="nn">app.forms</span> <span class="kn">import</span> <span class="n">CommentForm</span>


<span class="k">class</span> <span class="nc">CommentCreateView</span><span class="p">(</span><span class="n">CreateView</span><span class="p">,</span> <span class="n">JSONResponseMixin</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Comment</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">CommentForm</span>
</pre>
<p>Como vemos, es la implementación de lo que vendría siendo una vista basada
en clases normal y corriente para procesar un formulario, validarlo y crear
un nuevo registro de <em>Comment</em>, sólo una cosa salta a la vista: el <em>JSONResponseMixin</em>.
Veamos qué hace:</p>
<pre class="code python literal-block">
<span class="k">class</span> <span class="nc">JSONResponseMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">render_to_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_json_response</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_json_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
            <span class="n">content_type</span><span class="o">=</span><span class="s1">'application/json'</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
</pre>
<p>Y eso es todo, luego, si necesito hacer que alguna otra vista sea &quot;ajax friendly&quot;,
simplemente tengo que hacer que herede del <em>JSONResponseMixin</em>. Algo importante acá
es que si necesito serializar objetos complejos, <em>json.dumps()</em> no será suficiente,
debería escribir mi propio método para convertirlo en <em>JSON</em> y enviarlo.</p>
<p>Si te parece útil o interesante lo que escribo, suscríbete a mi lista de correos en
la caja que está a la derecha, tengo algunas cosas en mente que estaré anunciando por
esa vía. Gracias, de nuevo, por leerme.</p>
</div>


<div class="article-footer">
    <p><span class="glyphicon glyphicon-tag" aria-hidden="true"></span> <a href="tag/desarrollo.html">desarrollo</a> <a href="tag/mixins.html">mixins</a> <a href="tag/programacion.html">programación</a> </p>

    <p>Thank you for reading!, don't forget to subscribe to my mailing list!, I don't send any spam and sometimes I do share interesting stuff</p>


<!-- Begin MailChimp Signup Form -->
    <link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
    <style type="text/css">
        #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
        /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
           We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
    </style>
    <div id="mc_embed_signup">
    <form action="//iferminmontilla.us11.list-manage.com/subscribe/post?u=0d4b15ef6a90baa460d821dbc&amp;id=8b51ac80b2" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
        <div id="mc_embed_signup_scroll">
        
    <div class="mc-field-group">
        <label for="mce-EMAIL">Email Address </label>
        <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
    </div>
        <div id="mce-responses" class="clear">
            <div class="response" id="mce-error-response" style="display:none"></div>
            <div class="response" id="mce-success-response" style="display:none"></div>
        </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
        <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_0d4b15ef6a90baa460d821dbc_8b51ac80b2" tabindex="-1" value=""></div>
        <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
        </div>
    </form>
    </div>
    <script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
    <!--End mc_embed_signup-->


</div>

            </div>
        </div>
    </div>
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-8">
                    Created by <a href="http://iferminmontilla.com">Israel Fermín Montilla</a> using <a href="http://getpelican.com" target="_blank">Pelican</a> and <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>.
                    All content here is under <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US" target="_blank">Attribution-ShareAlike 3.0 Unported</a> license. Logo designed by <a href="https://about.me/andresfermin" target="_blank">Andrés Fermín</a>
                </div>
            </div>
        </div>
    </div>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
         })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55459920-1', 'auto');
  ga('send', 'pageview');

    </script>
</body>
</html>
