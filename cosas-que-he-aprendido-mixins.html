<!DOCTYPE html>
<html lang="en">
<head>
        <title>Cosas que he aprendido, Mixins</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css" />
        <link rel="stylesheet" href="http://localhost:8000/theme/css/main.css" />
        <link href="http://localhost:8000/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="/dev/isra/blog/* Full Atom Feed" />
        <link href="http://localhost:8000/feeds/espanol.atom.xml" type="application/atom+xml" rel="alternate" title="/dev/isra/blog/* Categories Atom Feed" />
</head>
<body>

    <div class="main-nav-container">

        <div class="pure-g">
            <div class="pure-u-1 pure-u-lg-2-3">
                <div class="main-nav">
                    <ul class="main-nav-list">
                        <li class="main-nav-item"><a href="http://localhost:8000/" class="pure-menu-link">/dev/isra/blog/*</a></li>

                        <li class="main-nav-item"><a href="http://localhost:8000/category/blog.html" class="pure-menu-link">Blog</a></li>
                        <li class="main-nav-item active"><a href="http://localhost:8000/category/espanol.html" class="pure-menu-link">Español</a></li>
                    </ul>
                </div>
             </div>

             <div class="pure-u-1 pure-u-lg-1-3"></div>
        </div>

    </div>


<div class="page-container">
    <div class="entry-content">
        <div class="post-meta pure-g">
            <div class="pure-u-3-4 meta-data">
                <a href="http://localhost:8000/category/espanol.html" class="category">Español</a><br />

                <a class="author" href="http://localhost:8000/author/israel-fermin-montilla.html">Israel Fermín Montilla</a>
                &mdash; <abbr title="2014-12-19T00:00:00+04:00">Fri 19 December 2014</abbr>
            </div>
        </div>
    </div>

    <div class="article-header-container">
        <div class="background-image-container">

            <div class="background-image-small">
                <div class="title-container">
                    <h1>Cosas que he aprendido, Mixins</h1>
                </div>
            </div>
        </div>
    </div>

    <div class="entry-content">
        <p>A menudo nos ocurre que estamos programando y vemos que hay ciertos
métodos que se repiten en varias clases, esto es una señal de que ese
conjunto de métodos pueden abstraerse de alguna manera para no tener que
duplicar esa lógica, entonces, escribimos una clase base, con esos
métodos y luego simplemente la heredamos y todo cool.</p>
<p>Cuando esto ocurre por segunda vez en un subconjunto de las clases
<em>hijas</em>, pueden pasar dos cosas:</p>
<ol>
<li>Ese conjunto de métodos pertenece al mismo dominio del problema, en
    cuyo caso, los colocamos en la clase padre que corresponda</li>
<li>Ese conjunto de métodos resuelve otro tipo de problemas o es más
    bien algún tipo de utilidad pero debe estar en esa clase por
    alguna razón.</li>
</ol>
<p>En el segundo caso lo que uno tiende a hacer con lenguajes que soportan
herencia múltiple como Python es crear una nueva clase y agregarla a la
lista de clases padre de la clase en cuestión.</p>
<p>Conforme nuestro programa va creciendo en complejidad, podemos
enfrentarnos al famoso problema del diamante de la herencia múltiple,
los mixins son una solución limpia y sencilla para evitar este tipo de
inconvenientes que son un dolor de cabeza para depurar y agregan
complicaciones innecesarias.</p>
<h2>¿Qué es un Mixin?</h2>
<p>Un Mixin es una clase que hereda de la clase por defecto, <em>object</em> en el
caso de Python, y define un conjunto de métodos para agregar
comportamiento a alguna otra entidad. Un mixin por sí solo puede
resultar inútil, pero al combinarlos y agregarlos a una clase resultan
ser una herramienta muy potente que ayuda a la reutilización de código
sin ambigüedades y sin generar efectos colaterales.</p>
<h2>Ejemplos</h2>
<p>Bueno, basta de palabrería y manos al teclado.</p>
<p>Supongamos que estamos desarrollando algo en <em>django</em> y necesitamos que
el usuario sea capaz de dejar comentarios, esta vista debe ser invocable
vía ajax. Debo hacerlo de manera que pueda reusar el código pues se que
en el futuro habrá más vistas que deben ser "ajax friendly"</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">CreateView</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="kn">from</span> <span class="nn">app.models</span> <span class="kn">import</span> <span class="n">Comment</span>
<span class="kn">from</span> <span class="nn">app.forms</span> <span class="kn">import</span> <span class="n">CommentForm</span>


<span class="k">class</span> <span class="nc">CommentCreateView</span><span class="p">(</span><span class="n">CreateView</span><span class="p">,</span> <span class="n">JSONResponseMixin</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Comment</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">CommentForm</span>
</pre></div>


<p>Como vemos, es la implementación de lo que vendría siendo una vista
basada en clases normal y corriente para procesar un formulario,
validarlo y crear un nuevo registro de <em>Comment</em>, sólo una cosa salta a
la vista: el <em>JSONResponseMixin</em>. Veamos qué hace:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">JSONResponseMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">render_to_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_json_response</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_json_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
            <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
</pre></div>


<p>Y eso es todo, luego, si necesito hacer que alguna otra vista sea "ajax
friendly", simplemente tengo que hacer que herede del
<em>JSONResponseMixin</em>. Algo importante acá es que si necesito serializar
objetos complejos, <em>json.dumps()</em> no será suficiente, debería escribir
mi propio método para convertirlo en <em>JSON</em> y enviarlo.</p>
<p>Si te parece útil o interesante lo que escribo, suscríbete a mi lista de
correos en la caja que está a la derecha, tengo algunas cosas en mente
que estaré anunciando por esa vía. Gracias, de nuevo, por leerme.</p>
    </div>

    <footer>
        <div class="tags">
            <a href="http://localhost:8000/tag/programacion.html">programación</a>
            <a href="http://localhost:8000/tag/mixins.html">mixins</a>
        </div>
        <div class="pure-g post-footer">
            <div class="pure-u-1 pure-u-md-1-2">
                <div class="pure-g poster-info">
                    <div class="pure-u-3-4">
                        <h3 class="author-name"><a href="http://localhost:8000/author/israel-fermin-montilla.html">Israel Fermín Montilla</a></h3>
                        <p class="author-description">
                        </p>
                    </div>
                </div>
            </div>



        </div>


    </footer>

    <div class="entry-content">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = 'iferminmblog';
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    </div>

</div>


    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-55459920-1', 'auto');
      ga('send', 'pageview');

    </script>
</body>
</html>