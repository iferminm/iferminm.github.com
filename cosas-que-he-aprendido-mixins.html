<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title>
   Cosas que he aprendido, Mixins - /dev/isra/blog/*
  </title>
  <meta charset="utf-8"/>
  <link href="http://fonts.googleapis.com/css?family=Arimo:400,700|Inika" rel="stylesheet" type="text/css"/>
  <link href="//iffm.me/theme/bootstrap.css" rel="stylesheet" type="text/css"/>
  <link href="//iffm.me/theme/pastie.css" rel="stylesheet" type="text/css"/>
  <link href="//127.0.0.1:8000/feeds/main.xml" rel="alternate" title="/dev/isra/blog/* Atom Feed" type="application/atom+xml"/>
  <script type="text/javascript">
   var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-96148260-1']);
  _gaq.push(['_trackPageview']);

  (function() {
	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script>
  <link href="//iffm.me/cosas-que-he-aprendido-mixins.html" rel="canonical"/>
  <script type="application/ld+json">
   {"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "/dev/isra/blog/*", "item": "//iffm.me"}, {"@type": "ListItem", "position": 2, "name": "Cosas que he aprendido mixins", "item": "//iffm.me/cosas-que-he-aprendido-mixins.html"}]}
  </script>
  <script type="application/ld+json">
   {"@context": "https://schema.org", "@type": "Article", "author": {"@type": "Person", "name": "Israel Fermín Montilla"}, "publisher": {"@type": "Organization", "name": "/dev/isra/blog/*"}, "headline": "Cosas que he aprendido, Mixins", "about": "Español", "datePublished": "2014-12-19 00:00"}
  </script>
 </head>
 <body>
  <div class="container">
   <div class="row">
    <div class="span8">
     <div id="content">
      <div class="header">
       <h1>
        Cosas que he aprendido, Mixins
       </h1>
      </div>
      <p class="meta">
       <small>
        <span>
         <a href="//iffm.me/author/israel-fermin-montilla/">
          Israel Fermín Montilla
         </a>
         -
        </span>
        <span>
         Fri 19 December 2014
        </span>
        -
        <span class="tags">
         <a href="/tag/programación/">
          programación
         </a>
         ,
         <a href="/tag/mixins/">
          mixins
         </a>
        </span>
       </small>
      </p>
      <div class="entry-content">
       <p>
        A menudo nos ocurre que estamos programando y vemos que hay ciertos
métodos que se repiten en varias clases, esto es una señal de que ese
conjunto de métodos pueden abstraerse de alguna manera para no tener que
duplicar esa lógica, entonces, escribimos una clase base, con esos
métodos y luego simplemente la heredamos y todo cool.
       </p>
       <p>
        Cuando esto ocurre por segunda vez en un subconjunto de las clases
        <em>
         hijas
        </em>
        , pueden pasar dos cosas:
       </p>
       <ol>
        <li>
         Ese conjunto de métodos pertenece al mismo dominio del problema, en
    cuyo caso, los colocamos en la clase padre que corresponda
        </li>
        <li>
         Ese conjunto de métodos resuelve otro tipo de problemas o es más
    bien algún tipo de utilidad pero debe estar en esa clase por
    alguna razón.
        </li>
       </ol>
       <p>
        En el segundo caso lo que uno tiende a hacer con lenguajes que soportan
herencia múltiple como Python es crear una nueva clase y agregarla a la
lista de clases padre de la clase en cuestión.
       </p>
       <p>
        Conforme nuestro programa va creciendo en complejidad, podemos
enfrentarnos al famoso problema del diamante de la herencia múltiple,
los mixins son una solución limpia y sencilla para evitar este tipo de
inconvenientes que son un dolor de cabeza para depurar y agregan
complicaciones innecesarias.
       </p>
       <h2>
        ¿Qué es un Mixin?
       </h2>
       <p>
        Un Mixin es una clase que hereda de la clase por defecto,
        <em>
         object
        </em>
        en el
caso de Python, y define un conjunto de métodos para agregar
comportamiento a alguna otra entidad. Un mixin por sí solo puede
resultar inútil, pero al combinarlos y agregarlos a una clase resultan
ser una herramienta muy potente que ayuda a la reutilización de código
sin ambigüedades y sin generar efectos colaterales.
       </p>
       <h2>
        Ejemplos
       </h2>
       <p>
        Bueno, basta de palabrería y manos al teclado.
       </p>
       <p>
        Supongamos que estamos desarrollando algo en
        <em>
         django
        </em>
        y necesitamos que
el usuario sea capaz de dejar comentarios, esta vista debe ser invocable
vía ajax. Debo hacerlo de manera que pueda reusar el código pues se que
en el futuro habrá más vistas que deben ser "ajax friendly"
       </p>
       <div class="highlight">
        <pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">CreateView</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="kn">from</span> <span class="nn">app.models</span> <span class="kn">import</span> <span class="n">Comment</span>
<span class="kn">from</span> <span class="nn">app.forms</span> <span class="kn">import</span> <span class="n">CommentForm</span>


<span class="k">class</span> <span class="nc">CommentCreateView</span><span class="p">(</span><span class="n">CreateView</span><span class="p">,</span> <span class="n">JSONResponseMixin</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Comment</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">CommentForm</span>
</code></pre>
       </div>
       <p>
        Como vemos, es la implementación de lo que vendría siendo una vista
basada en clases normal y corriente para procesar un formulario,
validarlo y crear un nuevo registro de
        <em>
         Comment
        </em>
        , sólo una cosa salta a
la vista: el
        <em>
         JSONResponseMixin
        </em>
        . Veamos qué hace:
       </p>
       <div class="highlight">
        <pre><span></span><code><span class="k">class</span> <span class="nc">JSONResponseMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">render_to_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_json_response</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_json_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
            <span class="n">content_type</span><span class="o">=</span><span class="s1">'application/json'</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
</code></pre>
       </div>
       <p>
        Y eso es todo, luego, si necesito hacer que alguna otra vista sea "ajax
friendly", simplemente tengo que hacer que herede del
        <em>
         JSONResponseMixin
        </em>
        . Algo importante acá es que si necesito serializar
objetos complejos,
        <em>
         json.dumps()
        </em>
        no será suficiente, debería escribir
mi propio método para convertirlo en
        <em>
         JSON
        </em>
        y enviarlo.
       </p>
       <p>
        Si te parece útil o interesante lo que escribo, suscríbete a mi lista de
correos en la caja que está a la derecha, tengo algunas cosas en mente
que estaré anunciando por esa vía. Gracias, de nuevo, por leerme.
       </p>
      </div>
      <!-- /.entry-content -->
      <div id="disqus_thread">
      </div>
      <script type="text/javascript">
       /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'iferminmblog'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
      </script>
      <noscript>
       Please enable JavaScript to view the
       <a href="http://disqus.com/?ref_noscript">
        comments powered by Disqus.
       </a>
      </noscript>
     </div>
    </div>
    <div class="span3 offset1">
     <div class="well">
      <ul class="nav nav-list">
       <li class="nav-header">
        Blog
       </li>
       <li>
        <a href="//iffm.me">
         Index
        </a>
       </li>
       <li>
        <a href="//iffm.me/tags/">
         Tags
        </a>
       </li>
       <li>
        <a href="//iffm.me/archives/">
         Archiv
        </a>
       </li>
       <li class="nav-header">
        Pages
       </li>
       <li>
        <a href="//iffm.me/pages/about-me.html">
         About me...
        </a>
       </li>
       <li>
        <a href="//iffm.me/pages/consulting.html">
         Consulting
        </a>
       </li>
       <li>
        <a href="//iffm.me/pages/now.html">
         Now
        </a>
       </li>
       <li>
        <a href="//iffm.me/pages/talks.html">
         Talks
        </a>
       </li>
       <li class="nav-header">
        Links
       </li>
       <li>
        <a href="http://getpelican.com/">
         Pelican
        </a>
       </li>
       <li>
        <a href="http://python.org/">
         Python.org
        </a>
       </li>
       <li>
        <a href="http://jinja.pocoo.org/">
         Jinja2
        </a>
       </li>
       <li>
        <a href="//iffm.me/feeds/all.atom.xml">
         Atom
        </a>
       </li>
      </ul>
     </div>
     <!-- /#menu -->
    </div>
   </div>
   <hr/>
   <div class="row">
    <div class="span12">
     <div id="about">
      <p>
       Proudly powered by
       <a href="http://twitter.github.com/bootstrap/">
        bootstrap
       </a>
       ,
       <a href="http://docs.notmyidea.org/alexis/pelican/">
        pelican
       </a>
       ,
       <a href="http://python.org">
        python
       </a>
       and
       <a href="http://www.julo.ch/about/">
        Alex
       </a>
       !
      </p>
     </div>
     <!-- /#about -->
    </div>
    <!-- /#contentinfo -->
   </div>
  </div>
  <script type="text/javascript">
   /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'iferminmblog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
  </script>
 </body>
</html>